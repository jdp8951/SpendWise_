package com.infosys.expenseManagementApplication.controller;
import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.infosys.expenseManagementApplication.bean.Category;
import com.infosys.expenseManagementApplication.bean.Customer;
import com.infosys.expenseManagementApplication.bean.Expense;
import com.infosys.expenseManagementApplication.dao.CustomerDao;
import com.infosys.expenseManagementApplication.dao.ExpenseDao;
import com.infosys.expenseManagementApplication.service.ExpenseUserService;

@RestController
@RequestMapping("/exp-mng/")
@CrossOrigin(origins = "http://localhost:5656")
public class ExpenseReportController {
	@Autowired
	private CustomerDao customerDao;
    @Autowired
    private ExpenseUserService service;
    
	@Autowired
    private ExpenseDao expenseDao;

	@GetMapping("/expense-number")
	public String generateExpenseNumber() {
		return expenseDao.generateExpenseNumber();
	}
	
	@GetMapping("/expenses")
	public List<Expense> getAllExpenses(){
		return expenseDao.getAllExpenses();
	}
	
	@GetMapping("/expense-cust")
    public List<Expense> getExpensesByCustomer(){
		String userId=service.getUserId();
		Customer customer=customerDao.getCustomerByUsername(userId);
		String customerId=customer.getCustomerId();
        return expenseDao.getExpensesByCustomer(customerId);
    }

    @GetMapping("/expense-cat")
    public List<Expense> getExpensesByCategory(@PathVariable Long categoryId) {
        return expenseDao.getExpensesByCategory(categoryId);
    }
    
    @PostMapping("/add-expense")
    public Expense addExpense(@RequestBody Expense expense) {
        return expenseDao.save(expense);
    }
    
    @DeleteMapping("/expense/{id}")
    public void deleteExpenseById(@PathVariable String id) {
    	expenseDao.deleteExpenseById(id);
    }
    
    @PutMapping("/category")
	public void updateExpense(@RequestBody Expense expense){
		expenseDao.save(expense);
	}
    
    
    
	//add put mapping too
	


}
